---
name: "Mic Platform v4"
description: "A new version of the Mic Platform, rebuilt with Tauri 2.0, React, and TypeScript."
category: "Desktop Application"
author: "juergenaltemeier"
authorUrl: "https://github.com/juergenaltemeier"
tags: ["tauri", "react", "typescript", "desktop"]
lastUpdated: "2025-07-10"
---

# Mic Platform v4

## Project Overview
A new version of the Mic Platform, rebuilt with Tauri 2.0, React, and TypeScript. This project aims to provide a modern, cross-platform desktop application with a focus on performance and a smaller bundle size compared to its Electron predecessor.

## Tech Stack
- **Frontend**: React, TypeScript, Vite
- **Backend**: Rust (via Tauri)
- **Package Manager**: npm

## Project Structure
The project is located in the `app` directory. The structure is generated by Tauri and follows standard practices for a React/Vite project with a Rust backend.
```
app/
├── src/
│   ├── components/
│   ├── pages/
│   └── ...
├── src-tauri/
│   ├── src/
│   └── Cargo.toml
├── public/
├── node_modules/
│   └── (Installed npm dependencies)
├── package.json
└── ...
```
The `node_modules` directory contains all the project's npm dependencies and is generated by the `npm install` command. It is typically excluded from version control.

## Development Guidelines

### Code Style
- Use consistent code formatting tools (e.g., Prettier, rustfmt)
- Follow language-specific best practices for TypeScript and Rust
- Keep code clean and readable

### Naming Conventions
- File naming: (e.g., `kebab-case` for files, `PascalCase` for components)
- Variable naming: `camelCase`
- Function naming: `camelCase`
- Class naming: `PascalCase`

### Git Workflow
- Branch naming conventions (e.g., `feature/`, `bugfix/`, `chore/`)
- Commit message format (e.g., Conventional Commits)
- Pull Request process

## Environment Setup

### Development Requirements
- **Node.js and npm:** [https://nodejs.org/](https://nodejs.org/)
- **Rust:** Install from [https://www.rust-lang.org/learn/get-started](https://www.rust-lang.org/learn/get-started)
- **OS-specific dependencies:** Follow the instructions for your operating system here: [https://tauri.app/start/prerequisites/](https://tauri.app/start/prerequisites/)

### Installation Steps
```bash
# 1. Navigate to the app directory
cd app

# 2. Install dependencies
npm install

# 3. Start development server
npm run tauri dev
```

## Core Feature Implementation

The core functionality of this application will be a port of the `mic-renamer` Python project. The goal is to rebuild its features using a modern stack of Rust for the backend logic and React/TypeScript for the user interface.

### 1. Renaming Engine (Rust Backend)

The primary business logic will reside in the `src-tauri/src/` directory, organized into modules. The existing `renamer.rs` will be the central hub for this logic.

-   **`renamer.rs`**: This module will expose Tauri commands to the frontend.
    -   `#[tauri::command] async fn get_files(paths: Vec<String>) -> Result<Vec<FileInfo>, String>`: Takes a list of file or directory paths, recursively finds all supported media files, and returns a `Vec` of `FileInfo` structs.
    -   `#[tauri::command] async fn preview_rename(files: Vec<FileState>) -> Result<Vec<RenamePreview>, String>`: Takes the current state of files from the frontend, generates the new filenames, and returns a list of `RenamePreview` structs (`{ original_path, new_path }`).
    -   `#[tauri::command] async fn perform_rename(files: Vec<FileState>) -> Result<String, String>`: Executes the actual file renaming on the filesystem and handles the undo history.
    -   `#[tauri::command] async fn undo_rename() -> Result<String, String>`: Reverts the last renaming operation.

-   **Data Structures (in `renamer.rs` or a new `models.rs`)**:
    -   `struct FileInfo`: `{ path: String, name: String, date: SystemTime, size: u64 }`
    -   `struct FileState`: `{ original_info: FileInfo, tags: Vec<String>, suffix: String, ... }` (Represents the state from the UI)
    -   `struct RenamePreview`: `{ original_path: String, new_path: String }`

### 2. User Interface (React Frontend)

The UI will be built as a single-page application in the `src/pages/Renamer.tsx` file, composed of smaller, reusable components from `src/components/`.

-   **`pages/Renamer.tsx`**: This will be the main view, orchestrating all other components.
    -   It will manage the application's central state, including the list of files, project number, and selected tags.
    -   It will use Tauri's `invoke` function to call the Rust backend commands (`get_files`, `preview_rename`, etc.).

-   **`components/FileTable.tsx`**:
    -   A virtualized table (e.g., using `TanStack Table`) to efficiently display thousands of files.
    -   Columns for filename, editable tags, editable date, and an editable suffix.
    -   Will use checkboxes for file selection.

-   **`components/TagPanel.tsx`**:
    -   Displays available tags loaded from a config file.
    -   Allows filtering tags via a search input.
    -   Checkboxes will support three states (checked, unchecked, indeterminate) to reflect the tag status across selected files.

-   **`components/Toolbar.tsx`**:
    -   Contains buttons for adding files/folders, triggering previews, opening settings, and the project number input field.
    -   File/folder selection will use Tauri's `dialog` API.

### 3. Configuration and State (Rust & React)

-   **Settings (Rust)**: A `Settings` struct in Rust will be serialized to a `settings.json` file in the user's app config directory (via `tauri::api::path::app_config_dir`). Commands like `load_settings` and `save_settings` will be exposed.
-   **Tags (Rust & Frontend)**: Tags will be defined in a `tags.json` within the config directory. Rust will read this file and pass the tag list to the frontend on startup.
-   **Session State (Frontend)**: The list of files and the project number will be managed in the React component state. This state will be passed to Rust commands for processing. For session persistence, the state can be saved to `localStorage` and rehydrated on app load.

### 4. Porting Plan Summary

| Python Module (`mic-renamer`) | Tauri/React Target | Notes |
| :--- | :--- | :--- |
| `logic/renamer.py` | `src-tauri/src/renamer.rs` | Port core filename generation and file system operations to Rust. |
| `logic/tag_service.py` | `renamer.rs` & `TagPanel.tsx` | Rust handles tag extraction from filenames; React handles UI logic. |
| `logic/image_compressor.py` | `src-tauri/src/compressor.rs` | Use Rust crates like `image` for compression. Expose as a command. |
| `ui/main_window.py` | `src/pages/Renamer.tsx` | Rebuild the main layout using React components. |
| `ui/components.py` | `src/components/*` | Create equivalent, modular React components. |
| `config/config_manager.py` | `src-tauri/src/settings.rs` | Use `serde` and `serde_json` for robust configuration handling in Rust. |

## Testing Strategy

### Unit Testing
- Testing framework: (e.g., Vitest, Jest)
- Test coverage requirements:
- Test file organization:

### Integration Testing
- Test scenarios:
- Testing tools:

### End-to-End Testing
- Test workflow:
- Automation tools:

## Deployment Guide

### Build Process
```bash
# Navigate to the app directory
cd app

# Build command
npm run tauri build
```

### Deployment Steps
1. Prepare production environment
2. Configure environment variables
3. Execute deployment scripts
4. Verify deployment results

### Environment Variables
```env
# Required environment variables
# e.g. VITE_API_URL=
```

## Performance Optimization

### Frontend Optimization
- Code splitting
- Lazy loading
- Caching strategies

### Backend Optimization
- Database query optimization
- Caching mechanisms
- Asynchronous operations in Rust

## Security Considerations

### Data Security
- Input validation
- Preventing Cross-Site Scripting (XSS)
- Securely handling file system access

### Authentication & Authorization
- User authentication flow
- Permission control
- Token management (if applicable)

## Monitoring and Logging

### Application Monitoring
- Performance metrics
- Error tracking
- User behavior analytics

### Log Management
- Log levels
- Log format
- Log storage

## Common Issues

### Issue 1: [Specific issue description]
**Solution**: Detailed solution steps

### Issue 2: [Specific issue description]
**Solution**: Detailed solution steps

## Reference Resources
- [Tauri Documentation](https://tauri.app/)
- [React Documentation](https://react.dev/)
- [Rust Documentation](https://www.rust-lang.org/learn)

## Changelog

### v0.1.0 (2025-07-10)
- Initial project setup with Tauri 2.0, React, and TypeScript.
- Created README.md and GEMINI.md.

---
**Note**: Please adjust and improve the above content according to the specific project type, remove inapplicable sections, and add project-specific content.
